/*! laser.js v1.0.0, 2013-07-31 */
(function(){"use strict";function t(t){var e="000000";return(e+t).slice(-e.length)}function e(){return(new Date).getTime()-i}var i=(new Date).getTime(),n={log:function(i){var n,s=i[0];i[0]="DEBUG ["+t(e())+"] > "+s,n=Function.prototype.bind.call(console.log,console),n.apply(console,i)}};"function"==typeof define&&define.amd?define("logger",function(){return n}):window.Logger=n})();var root="undefined"!=typeof require&&require.amd?{}:window,dfn="function"==typeof define&&define.amd?define:function(t,e,i){root.Laser=i.call(this,Logger)};(function(t,e){e("laser",["logger"],function(t){"use strict";function e(t){return void 0!==i(t)?!0:!1}function i(t){return-1!==k.indexOf(t)?t:O[t]?O[t]:void 0}function n(t,e){O[t]=e}function s(t,e){return Object.keys(e).forEach(function(i){t[i]=e[i]})}function o(t){var e,i,n,s,o,r;return r=t.css(d("Transform").css),"none"===r?0:(o=r.split("(")[1].split(")")[0].split(","),e=o[0],i=o[1],n=o[2],s=o[3],{scale:Math.sqrt(e*e+i*i),angle:Math.round(Math.atan2(i,e)*(180/Math.PI))})}function r(t){return y[t]}function a(t){return y[t]=r(t)||$(t),y[t]}function u(t,e,i){var n,s;return"string"==typeof t?(s=t.match(/^(-|\+)|(=)|([0-9]+$)/g),""===i?n=t:s&&3===s.length?(e=e.replace(/deg|px/,""),"-"===s[0]?n=e-s[2]+i:"+"===s[0]&&(n=e+s[2]+i)):/^[0-9]+$/.test(t)||(n=t)):n=""+t+i,n}function c(t,e){var i='<style id="'+t+'"> .'+t+" { "+e+"} </style>";return $("html > head").append(i),t}function h(){return["LASER_TR",++S].join("_")}function f(t){return t.replace(/-([a-z])/gi,function(t,e){return e.toUpperCase()})}function l(t){return t.charAt(0).toUpperCase()+t.slice(1)}function m(t){var e,i=f(t);return C.forEach(function(n){""===b[n+l(i)]&&(e={css:"-"+n.toLowerCase()+"-",om:n}),""===b[t.toLowerCase()]&&(e={css:"",om:""})}),e}function d(t){return{css:m(t).css+t.toLowerCase(),om:m(t).om+t}}function g(t,e,n,s){var o,r,a,c,h,f="",l="";return c=p(n),Object.keys(t).forEach(function(i){r=t[i],o=e[i],-1!==A.indexOf(i)?(a="perspective"===i?"px":"deg",a="scale"===i?"":a,""===h?h+=" "+i+"("+u(r,o,a)+") ":h=i+"("+u(r,o,a)+") "):(a="opacity"===i?"":"px",f+=d(i).css+" : "+u(r,o,a)+" !important;")}),l+=d("transition-duration").css+": "+c+" !important;",l+=d("transition-timing-function").css+":"+i(s)+"!important;",void 0!==h&&(l+=d("Transform").css+":"+h+" !important;"),l+=f}function p(t){return"string"!=typeof t||/^[0-9]+$/.test(t)?t/1e3+"s":t}function w(t){return/(rotate|scale)/.test(t)}function T(t,e){t.filter(function(){Object.keys(e).forEach(function(t,i,n){return n[t]!==e[t]?!1:!0})})}var v=function v(t){return s(this,t),this.listeners={},this.animations=[],this.DEBUG=this.DEBUG||!1,this.console="object"==typeof window.console,this},y={},E=document.createElement("div"),b=E.style,C=["","webkit","Moz","o","ms"];["webkitTransitionEnd","oTransitionEnd","otransitionend","transitionend","msTransitionEnd"].join(" ");var A=["matrix","matrix3d","translate","translate3d","translateX","translateY","translateZ","scale","scale3d","scaleX","scaleY","scaleZ","rotate","rotate3d","rotateX","rotateY","rotateZ","skew","skewX","skewY","perspective"],k=["ease","linear","ease-in","ease-out","ease-in-out"],O={};["rotate","rotateX","rotateY"].forEach(function(t){$.cssHooks[t]={get:function(t){var e=o($(t));return"("+e.angle+"deg)"},set:function(t,e){$(t).css(d("Transform").css,e)}}}),$.cssHooks.scale={get:function(t){return o($(t)).scale},set:function(t,e){$(t).css(d("Transform").css,e)}};var S=0,q=function q(t){return s(this,t),this.$elem.hasClass("animation")===!1&&(this.$elem.addClass("animation"),this.setInitialStyle()),this.state="ON_STACK",this};return q.prototype={getCurrentParams:function(){var t={};return Object.keys(this.params).forEach(function(e){w(e)&&(t.transform=this.$elem.css(e)),t[e]=this.$elem.css(e)},this),t},setInitialStyle:function(){var t,e;t=d("transition-duration").css,e=p(this.options.duration),this.initialStyle=t+":"+e+";"},play:function(){this.startParams=this.getCurrentParams(),this.state="PLAYING",this.transition()},complete:function(){this.sequence.trigger("animation:completed",this),this.state="COMPLETED"},pause:function(){Object.keys(this.getCurrentParams()).forEach(function(t){this.$elem.css(t,this.$elem.css(t))},this),this.$elem.removeClass(this.id),this.state="PAUSED"},resume:function(){this.$elem.addClass(this.id),Object.keys(this.getCurrentParams()).forEach(function(t,e){this.$elem.css(e,"")},this),this.completeTimeout=setTimeout(function(){this.complete()}.bind(this),this.options.duration),this.state="PLAYING"},rewind:function(){void 0!==this.initialStyle&&this.$elem.attr("style",this.initialStyle),this.$elem.removeClass(this.id),this.completeTimeout=setTimeout(function(){this.complete()}.bind(this),this.options.duration)},transition:function(){var t=g(this.params,this.startParams,this.options.duration,this.options.easing);c(this.id,t),this.$elem.addClass(this.id),this.completeTimeout=setTimeout(function(){this.complete()}.bind(this),this.options.duration)}},v.prototype={log:function(){var e=arguments;return this.console&&this.DEBUG?(t.log(e),this):this},get:function(t,e){return void 0===e?this[t]:T(this[t],params)},set:function(t,e,i){var n=this.get(t,e);if(!n)throw Error('Unknown Attribute: "'+t+'"');return Object.keys(i).forEach(function(t,e){result[e]=t},this),obj},on:function(t,e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),this},off:function(t){return this.listeners[t]&&delete this.listeners[t],this},trigger:function(t){if(!this.listeners[t])return this;var e=Array.prototype.slice.call(arguments,1);return this.listeners[t].forEach(function(t){t.apply(this,e)},this),this},add:function(t,i,n){var s,o=this,r=a(t);if(s=n.when||0,n.easing=n.easing||"ease-out",!e(n.easing))throw Error("Unknown easing method! - "+n.easing);return this.animations.push(new q({id:h(),when:s,params:i,options:n,sequence:o,selector:t,$elem:r})),this},addEasing:function(t,e){return n(t,e),this},onAnimated:function(){this.padTime?setTimeout(function(){this.trigger("sequence:completed")}.bind(this),this.padTime):(this.log("sequence completed"),this.trigger("sequence:completed"))},onAnimationComplete:function(){this.remaining--,0===this.remaining&&this.trigger("sequence:animated")},play:function(){var t=this.get("animations");return this.remaining=t.length,this.startedAt=(new Date).getTime(),this.trigger("sequence:started",this.remaining),this.log("starting sequence"),t.forEach(function(t){t.whenTimeout=setTimeout(function(){t.play()}.bind(this),t.when)},this),this.on("sequence:animated",function(){this.onAnimated()}),this.on("animation:completed",function(t){this.onAnimationComplete(t)}),this.state="playing",this},wait:function(t){this.padTime=t},pause:function(){return this.pausedAt=(new Date).getTime()-this.startedAt,this.log("pausing"),this.get("animations").forEach(function(t){switch(t.state){case"STOPPED":break;case"ON_STACK":t.state="ON_STACK_RESET",clearTimeout(t.whenTimeout);break;case"PLAYING":clearTimeout(t.completeTimeout),t.pause()}},this),this.trigger("sequence:paused"),this.state="paused",this},resume:function(){var t=this.pausedAt;return this.log("resuming"),this.get("animations").forEach(function(e){switch(e.state){case"PAUSED":e.resume();break;case"ON_STACK_RESET":e.whenTimeout=setTimeout(function(){e.play()}.bind(this),e.when-t),this.state="ON_STACK"}},this),this.trigger("sequence:resuming"),this.state="resuming",this},rewind:function(){var t,e;return t=this.getRunTime(),this.log("rewinding"),e=this.get("animations").map(function(e){return e.when=t-e.when-e.options.duration,e}),e.reverse(),e.forEach(function(t){t.whenTimeout=setTimeout(function(){t.rewind()}.bind(this),t.when)},this),this.direction="rewind",this.remaining=e.length,this.trigger("sequence:rewinding"),this.state="rewinding",this},getRunTime:function(){var t,e=this.get("animations");return t=e[e.length-1],t.when+t.options.duration},name:function(t){return this.name=t,this}},v})})(root,dfn);